from pwn import *
from Crypto.Util.number import bytes_to_long, long_to_bytes
import json

HOST = "socket.cryptohack.org"
PORT = 13375

r = remote(HOST, PORT)
N = 22266616657574989868109324252160663470925207690694094953312891282341426880506924648525181014287214350136557941201445475540830225059514652125310445352175047408966028497316806142156338927162621004774769949534239479839334209147097793526879762417526445739552772039876568156469224491682030314994880247983332964121759307658270083947005466578077153185206199759569902810832114058818478518470715726064960617482910172035743003538122402440142861494899725720505181663738931151677884218457824676140190841393217857683627886497104915390385283364971133316672332846071665082777884028170668140862010444247560019193505999704028222347577
e = 3
vote = b'\00VOTE FOR PEDRO'
vote_i = bytes_to_long(vote)

data = r.recvline()
# find k, x if k ** 3 == x * 256 ** 15 + vote_i by wolfram alpha
k = 1329227995784915872903807060280344576 + 855520592299350692515886317752220783
x = 1766847064778384329583297500742918515827483896875618958121606201292619776 + 3411545766764370159919739883537010404464853275806502320105726765405569024 + 2195746451544695482329638703137702351594352350098826940573865585131399267 + 471077023836794307624210564525189539145493821666300122722042586992903656
send = {'option': 'vote', 'vote': hex(k)[2:]}
send = json.dumps(send).encode()
r.sendline(send)

data = r.recvline()
print(data)
